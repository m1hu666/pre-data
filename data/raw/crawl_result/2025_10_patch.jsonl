[
    {
        "query_url": "https://api.github.com/repos/xmlunit/xmlunit/commits/b81d48b71dfd2868bdfc30a3e17ff973f32bc15b",
        "url": "https://api.github.com/repos/xmlunit/xmlunit/commits/b81d48b71dfd2868bdfc30a3e17ff973f32bc15b",
        "html_url": "https://github.com/xmlunit/xmlunit/commit/b81d48b71dfd2868bdfc30a3e17ff973f32bc15b",
        "message": "disable XSLT extension functions by default, add more configurers\n\nsee #264",
        "files": [
            {
                "sha": "ba16bbdf7bbdecde0f49dc1c4c7d448890af1dbe",
                "filename": "xmlunit-core/src/main/java/org/xmlunit/util/TransformerFactoryConfigurer.java",
                "status": "modified",
                "additions": 58,
                "deletions": 2,
                "changes": 60,
                "blob_url": "https://github.com/xmlunit/xmlunit/blob/b81d48b71dfd2868bdfc30a3e17ff973f32bc15b/xmlunit-core%2Fsrc%2Fmain%2Fjava%2Forg%2Fxmlunit%2Futil%2FTransformerFactoryConfigurer.java",
                "raw_url": "https://github.com/xmlunit/xmlunit/raw/b81d48b71dfd2868bdfc30a3e17ff973f32bc15b/xmlunit-core%2Fsrc%2Fmain%2Fjava%2Forg%2Fxmlunit%2Futil%2FTransformerFactoryConfigurer.java",
                "contents_url": "https://api.github.com/repos/xmlunit/xmlunit/contents/xmlunit-core%2Fsrc%2Fmain%2Fjava%2Forg%2Fxmlunit%2Futil%2FTransformerFactoryConfigurer.java?ref=b81d48b71dfd2868bdfc30a3e17ff973f32bc15b",
                "patch": "@@ -16,6 +16,7 @@\n import java.util.Collections;\n import java.util.HashMap;\n import java.util.Map;\n+import javax.xml.XMLConstants;\n import javax.xml.transform.TransformerConfigurationException;\n import javax.xml.transform.TransformerFactory;\n \n@@ -88,18 +89,51 @@ public static Builder builder() {\n     }\n \n     /**\n-     * The default instance which disables DTD loading but still\n+     * The default instance which disables DTD loading and extension functions but still\n      * allows loading of external stylesheets.\n      */\n     public static final TransformerFactoryConfigurer Default = builder()\n         .withDTDLoadingDisabled()\n+        .withExtensionFunctionsDisabled()\n+        .build();\n+\n+    /**\n+     * The instance which enables secure processing thus disables all external access as well as execution of extension\n+     * functions.\n+     *\n+     * @since XMLUnit 2.10.0\n+     */\n+    public static final TransformerFactoryConfigurer SecureProcessing = builder()\n+        .withSecureProcessingEnabled()\n         .build();\n \n     /**\n      * The instance which disables DTD loading as well as loading of\n-     * external stylesheets.\n+     * external stylesheets or extension functions.\n      */\n     public static final TransformerFactoryConfigurer NoExternalAccess = builder()\n+        .withDTDLoadingDisabled()\n+        .withExternalStylesheetLoadingDisabled()\n+        .withExtensionFunctionsDisabled()\n+        .build();\n+\n+    /**\n+     * The instance which disables DTD loading but still\n+     * allows loading of external stylesheets and extension functions.\n+     *\n+     * @since XMLUnit 2.10.0\n+     */\n+    public static final TransformerFactoryConfigurer NoDtdButExtensionFunctions = builder()\n+        .withDTDLoadingDisabled()\n+        .build();\n+\n+    /**\n+     * The instance which disables DTD loading as well as loading of\n+     * external stylesheets but allows extension functions.\n+     *\n+     * @since XMLUnit 2.10.0\n+     */\n+    public static final TransformerFactoryConfigurer NoExternalAccessButExtensionFunctions = builder()\n         .withDTDLoadingDisabled()\n         .withExternalStylesheetLoadingDisabled()\n         .build();\n@@ -192,5 +226,27 @@ public Builder withExternalStylesheetLoadingDisabled() {\n             // XMLConstants.ACCESS_EXTERNAL_STYLESHEET is not available in Java 6\n             return withSafeAttribute(\"http://javax.xml.XMLConstants/property/accessExternalStylesheet\", \"\");\n         }\n+\n+        /**\n+         * Configures the factory to not enable extension functions.\n+         * @return this\n+         *\n+         * @since XMLUnit 2.10.0\n+         */\n+        public Builder withExtensionFunctionsDisabled() {\n+            return withSafeAttribute(\"jdk.xml.enableExtensionFunctions\", \"false\");\n+        }\n+\n+        /**\n+         * Configures the factory to enable secure processing which disables all external access as well as execution of\n+         * extension functions.\n+         * @return this\n+         *\n+         * @since XMLUnit 2.10.0\n+         */\n+        public Builder withSecureProcessingEnabled() {\n+            return withFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true);\n+        }\n+\n     }\n }"
            }
        ]
    }
]